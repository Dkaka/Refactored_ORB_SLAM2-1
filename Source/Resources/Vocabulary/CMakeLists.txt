PROJECT(ORB-SLAM_Vocabulary)

if (${CMAKE_VERSION} VERSION_GREATER_EQUAL "3.18.0")
  add_custom_command(OUTPUT ORBvoc.txt file(ARCHIVE_EXTRACT INPUT ${CMAKE_CURRENT_SOURCE_DIR}/ORBvoc.txt.tar.gz))
  add_custom_command(OUTPUT ${DEFAULT_ORB_VOCABULARY_DIR} file(MAKE_DIRECTORY ${DEFAULT_ORB_VOCABULARY_DIR}))
  add_custom_command(OUTPUT ${DEFAULT_ORB_VOCABULARY} file(COPY INPUT ORBvoc.txt ${DEFAULT_ORB_VOCABULARY}))
else()
  add_custom_command(OUTPUT ORBvoc.txt COMMAND ${CMAKE_COMMAND} -E tar xvf ${CMAKE_CURRENT_SOURCE_DIR}/ORBvoc.txt.tar.gz)
  add_custom_command(OUTPUT ${DEFAULT_ORB_VOCABULARY_DIR} ${CMAKE_COMMAND} -E make_directory ${DEFAULT_ORB_VOCABULARY_DIR})
  add_custom_command(OUTPUT ${DEFAULT_ORB_VOCABULARY} COMMAND ${CMAKE_COMMAND} ORBvoc.txt ${DEFAULT_ORB_VOCABULARY})
endif()

add_custom_target(orb_vocabulary ALL DEPENDS ORBvoc.txt ${DEFAULT_ORB_VOCABULARY_DIR} ${DEFAULT_ORB_VOCABULARY})
